# create-plan.yaml - Research-and-Plan Workflow Recipe
#
# This recipe implements the /create-plan command functionality in Goose:
# 1. Research Phase: Analyze codebase and create research report
# 2. Planning Phase: Create implementation plan based on research
#
# Usage: goose run --recipe create-plan.yaml

version: "1.0.0"
title: "Create Implementation Plan"
description: "Research and create a new implementation plan for a feature or task"

parameters:
  - key: feature_description
    input_type: string
    requirement: required
    description: "Natural language description of the feature to implement"

  - key: complexity
    input_type: number
    requirement: optional
    default: 3
    description: "Research complexity level (1-4, default 3)"

instructions: |
  You are executing a research-and-plan workflow. Your goal is to create a comprehensive
  implementation plan for the requested feature.

  ## Input
  - Feature: {{ feature_description }}
  - Complexity: {{ complexity }}

  ## Workflow Steps

  ### Step 1: Understand the Request
  Analyze the feature description to understand:
  - What functionality is being requested
  - What parts of the codebase might be affected
  - What research is needed to create a good plan

  ### Step 2: Research Phase
  Explore the codebase to gather context:
  1. Search for related files and code patterns
  2. Understand existing architecture and conventions
  3. Identify dependencies and integration points
  4. Note any potential challenges or considerations

  Create a research summary documenting your findings.

  ### Step 3: Planning Phase
  Based on your research, create an implementation plan with:

  **Plan Structure**:
  - Overview: What the plan accomplishes
  - Research Summary: Key findings from Step 2
  - Success Criteria: How to verify the implementation works
  - Implementation Phases: Break the work into logical phases

  **For Each Phase Include**:
  - Objective: What this phase accomplishes
  - Tasks: Specific implementation steps
  - Testing: How to validate the phase
  - Dependencies: What must be done first

  ### Step 4: Output the Plan
  Present the complete implementation plan in markdown format.
  The plan should be actionable and provide clear guidance for implementation.

  ## Quality Standards
  - Plans should have at least 3 phases for non-trivial features
  - Each phase should be independently testable
  - Include specific file paths where changes will be made
  - Consider edge cases and error handling

prompt: "Create an implementation plan for: {{ feature_description }}"
